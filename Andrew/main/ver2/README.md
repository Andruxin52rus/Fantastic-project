channel function second version. Added SIMO and angle vector support.
